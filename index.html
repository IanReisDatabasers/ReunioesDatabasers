<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Atas de Reunião - Databasers</title>
  <style>
    /* ... estilo mantido igual ao seu original ... */
  </style>
</head>
<body>
<video autoplay muted loop id="bgVideo" class="video-background">
  <source src="src/background_heroArea_home.mp4" type="video/mp4">
  Seu navegador não suporta vídeos HTML5.
</video>

<header>
  <img src="src/logotipoDatabasersWhite.svg" alt="Databasers Logo" />
  <h1>Atas de Reunião - Painel: <span id="tituloPainel"></span></h1>
</header>

<label for="painelSelect">Selecione o Painel:</label>
<select id="painelSelect"></select>

<div id="atasContainer"></div>

<script>
  const painelSelect = document.getElementById("painelSelect");
  const atasContainer = document.getElementById("atasContainer");
  const tituloPainel = document.getElementById("tituloPainel");
  let atas = [];

  function formatarData(dateStr) {
    const dt = new Date(dateStr);
    return dt.toLocaleDateString('pt-BR') + ' ' + dt.toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'});
  }

  function renderizarAtas(painel) {
    tituloPainel.textContent = painel;
    const atasFiltradas = atas
      .filter(ata => ata.painel === painel)
      .sort((a,b) => new Date(b.data) - new Date(a.data));

    atasContainer.innerHTML = "";

    if (atasFiltradas.length === 0) {
      atasContainer.innerHTML = `<p class="no-data">Nenhuma ata encontrada para este painel.</p>`;
      return;
    }

    atasFiltradas.forEach(ata => {
      const divAta = document.createElement("div");
      divAta.style.marginBottom = "40px";

      divAta.innerHTML = `
        <table>
          <thead>
            <tr><th colspan="2">Detalhes da Reunião</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Data e Hora:</strong></td><td>${formatarData(ata.data)}</td></tr>
            <tr><td><strong>Meio:</strong></td><td>${ata.meio}</td></tr>
            <tr><td><strong>Participantes:</strong></td><td>${ata.participantes.join(", ")}</td></tr>
          </tbody>
        </table>

        <table>
          <thead>
            <tr><th>Tópico</th><th>Responsável</th><th>Pontos Tratados</th></tr>
          </thead>
          <tbody>
            ${ata.topicos.map(t => `
              <tr>
                <td>${t.titulo}</td>
                <td>${t.responsavel}</td>
                <td><ul>${t.pontos.map(p => `<li>${p}</li>`).join("")}</ul></td>
              </tr>
            `).join("")}
          </tbody>
        </table>

        <table>
          <thead>
            <tr><th>Ação</th><th>Objetivo</th><th>Responsável</th><th>Estimativa de Tempo</th><th>Prazo de Conclusão</th><th>Retorno para</th></tr>
          </thead>
          <tbody>
            ${ata.acoes.map(a => `
              <tr>
                <td>${a.acao}</td>
                <td style="white-space: pre-line;">${a.objetivo}</td>
                <td>${a.responsavel}</td>
                <td>${a.tempo}</td>
                <td>${formatarData(a.prazo)}</td>
                <td>${a.retorno}</td>
              </tr>
            `).join("") || `<tr><td colspan="6" style="text-align:center;">Nenhuma ação registrada.</td></tr>`}
          </tbody>
        </table>

        <p><strong>Observações:</strong> ${ata.observacoes || "Nenhuma observação."}</p>
      `;

      atasContainer.appendChild(divAta);
    });
  }

  async function carregarAtas() {
    try {
      const resposta = await fetch('atas.json');
      atas = await resposta.json();

      const paineisUnicos = [...new Set(atas.map(ata => ata.painel))].sort();

      if (paineisUnicos.length > 0) {
        paineisUnicos.forEach(painel => {
          const option = document.createElement("option");
          option.value = painel;
          option.textContent = painel;
          painelSelect.appendChild(option);
        });

        painelSelect.value = paineisUnicos[0];
        renderizarAtas(paineisUnicos[0]);
      } else {
        atasContainer.innerHTML = "<p class='no-data'>Nenhum painel disponível.</p>";
      }
    } catch (erro) {
      atasContainer.innerHTML = `<p class='no-data'>Erro ao carregar as atas: ${erro.message}</p>`;
    }
  }

  painelSelect.addEventListener("change", (e) => {
    renderizarAtas(e.target.value);
  });

  carregarAtas();
</script>
</body>
</html>
